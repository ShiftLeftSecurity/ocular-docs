# Finding real world vulnerabilities

This tutorial is a more technical writeup of the blog entry (TODO)

## CVE-2018-19859



## Creating the CPG


```
loadCpg("openrefine.bin.zip")
```

## Looking for the source

We start looking for imports, but our search term is too generic! 409 methods contain the value `Import` in their fullname. Note we also might catch methods with the name `org.my.NotImport.foo()`! 
```
ocular> cpg.method.fullName(".*Import.*").toList.size 
409
```

It is alsways a good idea for security researcher to check for low hanging fruits first and the lowest fruits are Servlet! If you haven't heard aboout servlets, there is plenty of documentation all over the internet, starting from [wikipedia](https://de.wikipedia.org/wiki/Servlet), going up to  [Oracle](https://docs.oracle.com/javaee/6/tutorial/doc/bnafe.html) or [tomcat](https://tomcat.apache.org/tomcat-9.0-doc/servletapi/javax/servlet/http/HttpServlet.html). 

One of the charactaristics of servlets are the `doGet`- and the `doPost`-handler, responsible for handling GET and POST requests. It is always worth a try to look for this methods in the code! 

By executing the query below we dropped by 400 and suddenly find 9 easily to manually reviewable methods.

```
ocular> cpg.method.fullName(".*Import.*do(Get|Post).*").toList.size 
> 9
```

Some methods are stored in an interesting class with the name `DefaultImportingController`. We enhance our query by replacing `Import` with `DefaultImportingController`. The result consists, not suppringly, of a `doGet` and a `doPost` method.
```
cpg.method.fullName(".*DefaultImportingController.*do(Get|Post).*").fullName.p

com.google.refine.importing.DefaultImportingController.doGet:void(javax.servlet.http.HttpServletRequest,javax.servlet.http.HttpServletResponse)
com.google.refine.importing.DefaultImportingController.doPost:void(javax.servlet.http.HttpServletRequest,javax.servlet.http.HttpServletResponse)
```

Looks like we found a intersting source! 
